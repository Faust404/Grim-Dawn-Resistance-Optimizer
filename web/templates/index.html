<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grim Dawn Resistance Optimizer</title>
  <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>‚ö° Grim Dawn Resistance Optimizer</h1>
      <p>Optimize your gear resistances with advanced algorithms</p>
    </div>

    <form method="post">
      <div class="section">
        <h2>‚öôÔ∏è Weapon Template</h2>
        <div class="form-group">
          <select id="template" name="template">
            <option value="one-hand-shield" {% if data.weapon_template == 'one-hand-shield' %}selected{% endif %}>One-Handed Weapon + Shield</option>
            <option value="one-hand-offhand" {% if data.weapon_template == 'one-hand-offhand' %}selected{% endif %}>One-Handed Weapon + Off-Hand</option>
            <option value="ranged-offhand" {% if data.weapon_template == 'ranged-offhand' %}selected{% endif %}>Ranged Weapon + Off-Hand</option>
            <option value="two-hand" {% if data.weapon_template == 'two-hand' %}selected{% endif %}>Two-Handed Weapon</option>
          </select>
        </div>
        <br>
      </div>

      <div class="section">
        <h2>‚öôÔ∏è Configuration</h2>
        <div class="form-group">
          <label for="char-level">Character Level:</label>
          <div class="resistance-input" style="max-width: 210px;">
            <input type="number" name="char-level" value="{{ data['Character Level'] or 100 }}" min="1" max="100">
          </div>
        </div>
        <div class="form-group">
          <label>Current Resistances:</label>
          <div class="resistance-grid">
            <div class="resistance-input">
              <label>Fire:</label>
              <input type="number" name="current-fire" value="{{ data['Fire Resistance'] or 40 }}" min="0" max="100">
            </div>
            <div class="resistance-input">
              <label>Cold:</label>
              <input type="number" name="current-cold" value="{{ data['Cold Resistance'] or 40 }}" min="0" max="100">
            </div>
            <div class="resistance-input">
              <label>Lightning:</label>
              <input type="number" name="current-lightning" value="{{ data['Lightning Resistance'] or 40 }}" min="0" max="100">
            </div>
            <div class="resistance-input">
              <label>Poison & Acid:</label>
              <input type="number" name="current-poison" value="{{ data['Poison & Acid Resistance'] or 40 }}" min="0" max="100">
            </div>
            <div class="resistance-input">
              <label>Pierce:</label>
              <input type="number" name="current-pierce" value="{{ data['Pierce Resistance'] or 40 }}" min="0" max="100">
            </div>
            <div class="resistance-input">
              <label>Bleeding:</label>
              <input type="number" name="current-bleeding" value="{{ data['Bleeding Resistance'] or 40 }}" min="0" max="100">
            </div>
            <div class="resistance-input">
              <label>Vitality:</label>
              <input type="number" name="current-vitality" value="{{ data['Vitality Resistance'] or 40 }}" min="0" max="100">
            </div>
            <div class="resistance-input">
              <label>Aether:</label>
              <input type="number" name="current-aether" value="{{ data['Aether Resistance'] or 40 }}" min="0" max="100">
            </div>
            <div class="resistance-input">
              <label>Chaos:</label>
              <input type="number" name="current-chaos" value="{{ data['Chaos Resistance'] or 40 }}" min="0" max="100">
            </div>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>‚öôÔ∏è Unavailable Component Slots</h2>
        <div class="form-group">
          <div class="locations">
            <label><input type="checkbox" name="component-head" {% if component_slots['Helm'] %}checked{% endif %}> Head</label>
            <label><input type="checkbox" name="component-chest" {% if component_slots['Chest'] %}checked{% endif %}> Chest</label>
            <label><input type="checkbox" name="component-shoulder" {% if component_slots['Shoulders'] %}checked{% endif %}> Shoulders</label>
            <label><input type="checkbox" name="component-hand" {% if component_slots['Gloves'] %}checked{% endif %}> Gloves</label>
            <label><input type="checkbox" name="component-foot" {% if component_slots['Boots'] %}checked{% endif %}> Boots</label>
            <label><input type="checkbox" name="component-legs" {% if component_slots['Pants'] %}checked{% endif %}> Pants</label>
            <label><input type="checkbox" name="component-belt" {% if component_slots['Belt'] %}checked{% endif %}> Belt</label>
            <label><input type="checkbox" name="component-amulet" {% if component_slots['Amulet'] %}checked{% endif %}> Amulet</label>
            <label><input type="checkbox" name="component-ring1" {% if component_slots['Ring1'] %}checked{% endif %}> Ring 1</label>
            <label><input type="checkbox" name="component-ring2" {% if component_slots['Ring2'] %}checked{% endif %}> Ring 2</label>
            <label><input type="checkbox" name="component-medal" {% if component_slots['Medal'] %}checked{% endif %}> Medal</label>
            <label><input type="checkbox" name="component-weapon" {% if component_slots['Weapon'] %}checked{% endif %}> Weapon</label>
            <label><input type="checkbox" name="component-shield" {% if component_slots['Shield'] %}checked{% endif %}> Shield</label>
            <label><input type="checkbox" name="component-offhand" {% if component_slots['Off-Hand'] %}checked{% endif %}> Off-Hand</label>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>‚öôÔ∏è Unavailable Augment Slots</h2>
        <div class="form-group">
          <div class="locations">
            <label><input type="checkbox" name="augment-head" {% if augment_slots['Helm'] %}checked{% endif %}> Head</label>
            <label><input type="checkbox" name="augment-chest" {% if augment_slots['Chest'] %}checked{% endif %}> Chest</label>
            <label><input type="checkbox" name="augment-shoulder" {% if augment_slots['Shoulders'] %}checked{% endif %}> Shoulders</label>
            <label><input type="checkbox" name="augment-hand" {% if augment_slots['Gloves'] %}checked{% endif %}> Gloves</label>
            <label><input type="checkbox" name="augment-foot" {% if augment_slots['Boots'] %}checked{% endif %}> Boots</label>
            <label><input type="checkbox" name="augment-legs" {% if augment_slots['Pants'] %}checked{% endif %}> Pants</label>
            <label><input type="checkbox" name="augment-belt" {% if augment_slots['Belt'] %}checked{% endif %}> Belt</label>
            <label><input type="checkbox" name="augment-amulet" {% if augment_slots['Amulet'] %}checked{% endif %}> Amulet</label>
            <label><input type="checkbox" name="augment-ring1" {% if augment_slots['Ring1'] %}checked{% endif %}> Ring 1</label>
            <label><input type="checkbox" name="augment-ring2" {% if augment_slots['Ring2'] %}checked{% endif %}> Ring 2</label>
            <label><input type="checkbox" name="augment-medal" {% if augment_slots['Medal'] %}checked{% endif %}> Medal</label>
            <label><input type="checkbox" name="augment-weapon" {% if augment_slots['Weapon'] %}checked{% endif %}> Weapon</label>
            <label><input type="checkbox" name="augment-shield" {% if augment_slots['Shield'] %}checked{% endif %}> Shield</label>
            <label><input type="checkbox" name="augment-offhand" {% if augment_slots['Off-Hand'] %}checked{% endif %}> Off-Hand</label>
          </div>
        </div>
      </div>

      <button type="submit" class="optimize-btn">üöÄ Run Optimization</button>
    </form>

    {% if results %}
    <div class="section results">
      <h2>Results</h2>

      <table class="results-table">
      <thead>
        <tr>
          <th>Gear Slot</th>
          <th>Component</th>
          <th>Augment</th>
        </tr>
      </thead>
      <tbody>
        {% for slot, values in results.items() %}
        <tr>
          <td>{{ slot }}</td>
          <td>
            {% if values.Component.Name %}
              {% if values.Component.Name == "Slot Unavailable" %}
                <span style="color: #ff6b6b; font-weight: 600;">{{ values.Component.Name }}</span>
              {% elif values.Component.Url %}
                <a href="{{ values.Component.Url }}" target="_blank">{{ values.Component.Name }}</a>
              {% else %}
                {{ values.Component.Name }}
              {% endif %}
            {% else %}
              <span style="color: #888;">-</span>
            {% endif %}
          </td>
          <td>
            {% if values.Augment.Name %}
              {% if values.Augment.Name == "Slot Unavailable" %}
                <span style="color: #ff6b6b; font-weight: 600;">{{ values.Augment.Name }}</span>
              {% elif values.Augment.Url %}
                <a href="{{ values.Augment.Url }}" target="_blank">{{ values.Augment.Name }}</a>
              {% else %}
                {{ values.Augment.Name }}
              {% endif %}
            {% else %}
              <span style="color: #888;">-</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    </div>
    {% endif %}

    {% if final_resistances %}
    <div class="section final-resistances">
      <h2>Final Resistances</h2>
      <table class="resistances-table">
        <thead>
          <tr>
            <th>Type</th>
            <th>Value</th>
          </tr>
        </thead>
        <tbody>
          {% for res, val in final_resistances.items() %}
          <tr>
            <td>{{ res }}</td>
            <td>
              <span class="res-val 
                {% if val >= 80 %}success
                {% elif val >= 50 %}warning
                {% else %}danger
                {% endif %}">
                {{ val }}%
              </span>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endif %}

  </div>
</body>
</html>
